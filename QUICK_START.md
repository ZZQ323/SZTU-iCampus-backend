# SZTU-iCampus 快速启动指南

## 🚀 快速体验前后端连接效果

### 第一步：启动后端服务

1. **进入后端目录**
   ```bash
   cd backend
   ```

2. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

3. **初始化数据库和测试数据**
   ```bash
   python setup_db.py
   ```
   > 这会自动创建数据库表并添加5个测试公告

4. **启动后端服务**
   ```bash
   python run.py
   ```
   > 后端服务将在 http://localhost:8000 启动

### 第二步：查看API效果

打开浏览器访问以下地址，可以看到真实的API返回数据：

- **API文档**: http://localhost:8000/docs
- **公告接口**: http://localhost:8000/api/announcements  
- **流式接口**: http://localhost:8000/api/announcements/stream

### 第三步：启动前端小程序

1. **打开微信开发者工具**

2. **导入项目**
   - 选择 `miniprogram` 文件夹
   - AppID可以选择测试号或留空

3. **查看效果**
   - 首页将显示后端返回的真实公告数据
   - 点击公告可以查看详情
   - 公告页面也将显示完整的公告列表

## 🎯 预期效果

### 首页效果
- ✅ 显示用户信息
- ✅ 功能导航区（4个主要功能）
- ✅ 快捷服务区（成绩、考试、校园卡、图书馆）
- ✅ **最新公告区显示真实的后端数据**

### 公告页面效果
- ✅ 显示所有公告列表
- ✅ 显示部门信息
- ✅ 显示发布时间
- ✅ 点击查看详情

### 课表页面效果
- ✅ 显示周课表格布局
- ✅ 显示课程详细信息
- ✅ 支持课程点击查看详情
- ✅ 显示每日课程列表

### 部门通知页面效果
- ✅ 支持部门和类型筛选
- ✅ 显示通知优先级和类型标签
- ✅ 显示通知发布时间和部门
- ✅ 点击查看通知详细内容

### 活动日历页面效果
- ✅ 支持活动类型和状态筛选
- ✅ 显示活动类型和状态标签
- ✅ 显示活动时间、地点、主办方
- ✅ 显示参与人数和进度条
- ✅ 点击查看活动详细信息

### 成绩查询页面效果
- ✅ 支持学期、学年、课程类型筛选
- ✅ 显示GPA、总学分、平均分等统计信息
- ✅ 显示详细的成绩分解（平时、期中、期末）
- ✅ 显示班级排名和成绩等级
- ✅ 点击查看成绩详细信息

### API数据格式

**公告接口数据格式**：
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "announcements": [
      {
        "id": 1,
        "title": "关于2024年春季学期开学安排的通知",
        "content": "各位同学：...",
        "department": "教务处",
        "date": "2024-01-15",
        "time": "10:30"
      }
    ],
    "total": 5
  }
}
```

**课表接口数据格式**：
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "schedules": [
      {
        "id": 1,
        "course_name": "高等数学",
        "teacher": "王教授",
        "classroom": "A101",
        "week_day": 1,
        "start_time": "08:30",
        "end_time": "10:10",
        "weeks": "1-16周",
        "course_type": "必修",
        "credits": "4"
      }
    ],
    "total": 9,
    "current_week": 1,
    "student_id": "2024001"
  }
}
```

**通知接口数据格式**：
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "notices": [
      {
        "id": 1,
        "title": "【紧急通知】期末考试时间调整",
        "content": "各位同学注意：...",
        "department": "教务处",
        "notice_type": "URGENT",
        "priority": "HIGH",
        "target_audience": "全体学生",
        "date": "2024-01-10",
        "time": "09:00"
      }
    ],
    "total": 5
  }
}
```

**活动接口数据格式**：
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "events": [
      {
        "id": 1,
        "title": "2024年春季学术论坛",
        "description": "本次学术论坛将邀请国内外知名学者分享最新研究成果...",
        "organizer": "学术委员会",
        "event_type": "academic",
        "status": "upcoming",
        "location": "学术报告厅（主楼A座201）",
        "start_time": "2024-03-15 14:00",
        "end_time": "2024-03-15 17:00",
        "max_participants": 200,
        "current_participants": 45
      }
    ],
    "total": 6
  }
}
```

**成绩接口数据格式**：
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "grades": [
      {
        "id": 1,
        "course_code": "MATH001",
        "course_name": "高等数学A(一)",
        "course_type": "必修",
        "credits": 4.0,
        "semester": "2023-2024-1",
        "teacher_name": "王教授",
        "regular_score": 85.0,
        "midterm_score": 88.0,
        "final_score": 92.0,
        "total_score": 89.0,
        "grade_level": "B+",
        "gpa_points": 3.3,
        "class_rank": 12,
        "class_total": 45
      }
    ],
    "total": 8,
    "summary": {
      "total_courses": 8,
      "total_credits": 23.5,
      "avg_score": 90.06,
      "avg_gpa": 3.45,
      "pass_rate": 100.0
    }
  }
}
```

## 🔧 故障排除

### 后端问题
- **端口占用**: 修改 `run.py` 中的端口号
- **数据库错误**: 删除 `sztu_icampus.db` 文件重新运行 `setup_db.py`
- **依赖问题**: 确保Python版本 >= 3.8

### 前端问题
- **网络请求失败**: 检查后端是否正常启动
- **数据不显示**: 打开小程序调试器查看控制台日志
- **CORS错误**: 后端已配置允许所有来源，应该不会出现

## 📱 功能演示

### 1. 校园公告功能 ✅ **已完成前后端连接**
- 后端提供REST API
- 前端显示公告列表
- 支持点击查看详情
- 支持下拉刷新

### 2. 课表查询功能 ✅ **已完成前后端连接**
- 后端提供课表API接口
- 前端显示周课表格和列表
- 支持课程详情查看
- 支持下拉刷新

### 3. 部门通知功能 ✅ **已完成前后端连接**
- 后端提供通知API接口，支持部门和类型筛选
- 前端显示通知列表，支持优先级标签
- 支持紧急、普通、信息三种通知类型
- 支持高、中、低三种优先级显示

### 4. 活动日历功能 ✅ **已完成前后端连接**
- 后端提供活动API接口，支持类型和状态筛选
- 前端显示活动列表，包含类型和状态标签
- 支持学术、社团、体育、文化、比赛五种活动类型
- 支持即将开始、进行中、已结束三种状态显示

### 5. 成绩查询功能 ✅ **已完成前后端连接**
- 后端提供成绩API接口，支持学期和课程类型筛选
- 前端显示成绩列表，包含详细的成绩分解
- 支持GPA统计、通过率计算、班级排名显示
- 支持平时、期中、期末成绩分项查看

### 6. 流式数据传输 ✅ **已实现**
- 公告流：http://localhost:8000/api/announcements/stream
- 通知流：http://localhost:8000/api/notices/stream
- 活动流：http://localhost:8000/api/events/stream
- 成绩流：http://localhost:8000/api/grades/stream

### 7. 其他功能 🚧 **待实现**
- 用户认证系统
- 图书馆系统
- 校园卡功能
- 等等...

## 🎉 成功标志

当你看到以下效果时，说明前后端连接成功：

1. **后端控制台显示**：
   ```
   INFO:     Uvicorn running on http://0.0.0.0:8000
   INFO:     Started reloader process
   ```

2. **小程序首页显示**：
   - 最新公告区显示5条真实数据
   - 每条公告显示标题、部门、日期时间

3. **小程序公告页显示**：
   - 完整的公告列表
   - 可以点击查看详情

4. **小程序课表页显示**：
   - 显示周课表格和课程列表
   - 可以点击课程查看详情
   - 显示9门课程的详细信息

5. **小程序通知页显示**：
   - 显示部门通知列表，包含优先级标签
   - 支持按部门和类型筛选
   - 可以点击查看通知详细内容
   - 显示5条不同类型的通知

6. **小程序活动页显示**：
   - 显示校园活动列表，包含类型和状态标签
   - 支持按活动类型和状态筛选
   - 显示活动参与人数和进度条
   - 可以点击查看活动详细信息
   - 显示6个不同类型的活动

7. **小程序成绩页显示**：
   - 显示学生成绩列表，包含统计信息卡片
   - 支持按学期、学年、课程类型筛选
   - 显示GPA、总学分、平均分、通过率
   - 显示成绩分解（平时、期中、期末）
   - 显示8门课程的详细成绩

8. **浏览器API测试**：
   - 访问公告接口返回JSON数据
   - 访问课表接口返回课程数据
   - 访问通知接口返回通知数据
   - 访问活动接口返回活动数据
   - 访问成绩接口返回成绩数据
   - 数据格式正确，包含中文内容

## 🚀 下一步开发建议

优先级建议：

1. **实现用户认证系统** - 连接微信登录，实现个性化数据
2. **开发图书馆系统** - 图书查询、借阅记录、续借功能
3. **开发校园卡功能** - 余额查询、消费记录、充值功能
4. **完善详情页功能** - 公告、通知、活动详情页面
5. **添加考试安排功能** - 考试时间、地点、座位查询
6. **完善现有功能** - 添加数据导出、周次切换等

---

**问题反馈**: 如果遇到问题，请检查控制台日志并提供错误信息。 