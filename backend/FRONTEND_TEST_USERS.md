# SZTU-iCampus å‰ç«¯æµ‹è¯•ç”¨æˆ·åˆ—è¡¨

## ğŸ”— API é…ç½®
- **åç«¯åœ°å€**: `http://localhost:8000/api/v1`
- **æµå¼æ¨é€ç«¯ç‚¹**: `/stream/events`
- **å¢é‡åŒæ­¥ç«¯ç‚¹**: `/stream/sync`
- **ç³»ç»ŸçŠ¶æ€ç«¯ç‚¹**: `/stream/status`

## ğŸ‘¥ å›ºå®šæµ‹è¯•ç”¨æˆ· (æ‰€æœ‰å¯†ç : 123456)

### ğŸ“š å­¦ç”Ÿç”¨æˆ· (å¯æ¥æ”¶äº‹ä»¶: æˆç»©ã€æ¶ˆè´¹ã€å›¾ä¹¦ã€è¯¾ç¨‹å˜æ›´)
| ç™»å½•ID | å§“å | èº«ä»½ | å¯æ¥æ”¶äº‹ä»¶ |
|--------|------|------|-----------|
| `202100000001` | å”å‹‡ | å­¦ç”Ÿ | æˆç»©æ›´æ–°ã€æ¶ˆè´¹æµæ°´ã€å›¾ä¹¦æé†’ã€è¯¾ç¨‹å˜æ›´ |
| `202100000002` | éƒ­æ–‡ | å­¦ç”Ÿ | æˆç»©æ›´æ–°ã€æ¶ˆè´¹æµæ°´ã€å›¾ä¹¦æé†’ã€è¯¾ç¨‹å˜æ›´ |
| `202100000003` | å‘¨å¹³ | å­¦ç”Ÿ | æˆç»©æ›´æ–°ã€æ¶ˆè´¹æµæ°´ã€å›¾ä¹¦æé†’ã€è¯¾ç¨‹å˜æ›´ |
| `202100000004` | é»„å¼º | å­¦ç”Ÿ | æˆç»©æ›´æ–°ã€æ¶ˆè´¹æµæ°´ã€å›¾ä¹¦æé†’ã€è¯¾ç¨‹å˜æ›´ |
| `202100000005` | å¾ä¸½ | å­¦ç”Ÿ | æˆç»©æ›´æ–°ã€æ¶ˆè´¹æµæ°´ã€å›¾ä¹¦æé†’ã€è¯¾ç¨‹å˜æ›´ |

### ğŸ‘¨â€ğŸ« æ•™å¸ˆç”¨æˆ· (å¯æ¥æ”¶äº‹ä»¶: è¯¾ç¨‹å˜æ›´ã€ç³»ç»Ÿæ¶ˆæ¯)
| ç™»å½•ID | å§“å | èº«ä»½ | å¯æ¥æ”¶äº‹ä»¶ |
|--------|------|------|-----------|
| `2025001001` | é«˜å†› | æ•™å¸ˆ | è¯¾ç¨‹å˜æ›´ã€ç³»ç»Ÿæ¶ˆæ¯ |
| `2025001002` | é™ˆå»ºå | æ•™å¸ˆ | è¯¾ç¨‹å˜æ›´ã€ç³»ç»Ÿæ¶ˆæ¯ |

### ğŸ‘” ç®¡ç†å‘˜ç”¨æˆ· (å¯æ¥æ”¶äº‹ä»¶: æ‰€æœ‰ç±»å‹)
| ç™»å½•ID | å§“å | èº«ä»½ | å¯æ¥æ”¶äº‹ä»¶ |
|--------|------|------|-----------|
| `2025000001` | ä½•å¹³ | ç®¡ç†å‘˜ | æ‰€æœ‰äº‹ä»¶ç±»å‹ |

## ğŸ“¨ æ¨é€äº‹ä»¶ç±»å‹

### ğŸ”” å…¬å¼€äº‹ä»¶ (æ‰€æœ‰ç”¨æˆ·éƒ½èƒ½æ”¶åˆ°)
- **ç³»ç»Ÿå…¬å‘Š** (`announcement`)
  - ç¤ºä¾‹: "å…³äºæœŸæœ«è€ƒè¯•å®‰æ’çš„é‡è¦é€šçŸ¥"
  - å‘å¸ƒè€…: æ•™åŠ¡å¤„

### ğŸ”’ ç§äººäº‹ä»¶ (ä»…ç›¸å…³ç”¨æˆ·æ”¶åˆ°)

#### ğŸ“Š æˆç»©æ›´æ–° (`grade_update`) - ä»…å­¦ç”Ÿ
- ç¤ºä¾‹æ•°æ®:
  ```json
  {
    "course_name": "é«˜ç­‰æ•°å­¦A",
    "score": 90,
    "grade_level": "A-",
    "semester": "2024-2025-1"
  }
  ```

#### ğŸ’³ æ¶ˆè´¹æµæ°´ (`transaction`) - ä»…å­¦ç”Ÿ
- ç¤ºä¾‹æ•°æ®:
  ```json
  {
    "amount": -15.50,
    "location": "ç¬¬ä¸€é£Ÿå ‚",
    "balance": 284.50
  }
  ```

#### ğŸ“š å›¾ä¹¦æé†’ (`library_reminder`) - ä»…å­¦ç”Ÿ
- ç¤ºä¾‹æ•°æ®:
  ```json
  {
    "book_title": "ç®—æ³•å¯¼è®ºï¼ˆç¬¬ä¸‰ç‰ˆï¼‰",
    "due_date": "2024-12-25",
    "days_left": 4
  }
  ```

#### ğŸ“… è¯¾ç¨‹å˜æ›´ (`course_change`) - å­¦ç”Ÿå’Œæ•™å¸ˆ
- ç¤ºä¾‹æ•°æ®:
  ```json
  {
    "course_name": "æ•°æ®ç»“æ„ä¸ç®—æ³•",
    "teacher": "ææ•™æˆ",
    "old_schedule": "å‘¨ä¸€ 08:30-10:10 @ C2-301",
    "new_schedule": "å‘¨ä¸€ 10:30-12:10 @ C2-305",
    "reason": "æ•™å®¤è®¾å¤‡ç»´æŠ¤"
  }
  ```

## ğŸ§ª å‰ç«¯æµ‹è¯•æµç¨‹

### 1. ç™»å½•æµ‹è¯•
```javascript
// ä½¿ç”¨ä»»æ„æµ‹è¯•ç”¨æˆ·ç™»å½•
const loginData = {
  username: "202100000001",  // å”å‹‡ (å­¦ç”Ÿ)
  password: "123456"
};
```

### 2. åˆå§‹åŒ–StreamManager
```javascript
// åœ¨app.jsä¸­åˆå§‹åŒ–
const { streamManager } = require('./utils/stream.js');

// ç›‘å¬ç¼“å­˜åŠ è½½äº‹ä»¶
streamManager.addEventListener('cache_loaded', (data) => {
  console.log('ç¼“å­˜æ•°æ®åŠ è½½:', data);
});

// ç›‘å¬å¢é‡åŒæ­¥äº‹ä»¶
streamManager.addEventListener('incremental_sync', (data) => {
  console.log('æ”¶åˆ°æ–°äº‹ä»¶:', data.newEvents);
});

// ç›‘å¬å®æ—¶äº‹ä»¶
streamManager.addEventListener('realtime_event', (event) => {
  console.log('å®æ—¶äº‹ä»¶:', event);
});
```

### 3. è§¦å‘æ¨é€æµ‹è¯•
```bash
# åœ¨åç«¯ç›®å½•è¿è¡Œæµ‹è¯•è„šæœ¬
cd backend
python test_event_push.py

# é€‰æ‹© "1. è¿è¡Œå®Œæ•´æµ‹è¯•åœºæ™¯"
# ä¼šä¾æ¬¡æ¨é€: å…¬å‘Š â†’ æˆç»© â†’ æ¶ˆè´¹ â†’ å›¾ä¹¦ â†’ è¯¾ç¨‹å˜æ›´
```

### 4. éªŒè¯äº‹ä»¶æ¥æ”¶
- **å…¬å¼€äº‹ä»¶**: æ‰€æœ‰ç™»å½•ç”¨æˆ·éƒ½åº”è¯¥æ”¶åˆ°ç³»ç»Ÿå…¬å‘Š
- **ç§äººäº‹ä»¶**: 
  - å­¦ç”Ÿç”¨æˆ·æ”¶åˆ°: æˆç»©ã€æ¶ˆè´¹ã€å›¾ä¹¦ã€è¯¾ç¨‹å˜æ›´
  - æ•™å¸ˆç”¨æˆ·æ”¶åˆ°: è¯¾ç¨‹å˜æ›´
  - ç®¡ç†å‘˜ç”¨æˆ·æ”¶åˆ°: æ‰€æœ‰äº‹ä»¶

## ğŸ”„ å¢é‡åŒæ­¥é€»è¾‘éªŒè¯

1. **å¯åŠ¨æ—¶**: ç«‹å³æ˜¾ç¤ºç¼“å­˜æ•°æ® âœ…
2. **åœ¨çº¿æ—¶**: åå°è¯·æ±‚æœ€æ–°æ•°æ®å¹¶æ›´æ–° âœ…
3. **ç¦»çº¿æ—¶**: ä»…æ˜¾ç¤ºç¼“å­˜æ•°æ® âœ…
4. **ç½‘ç»œæ¢å¤**: è‡ªåŠ¨å¢é‡åŒæ­¥é”™è¿‡çš„äº‹ä»¶ âœ…

## ğŸ“± å‰ç«¯é›†æˆå»ºè®®

```javascript
// åœ¨é¡µé¢ä¸­ç›‘å¬ç‰¹å®šäº‹ä»¶
Page({
  onLoad() {
    // ç›‘å¬æˆç»©æ›´æ–°
    streamManager.addEventListener('realtime_event', (event) => {
      if (event.event_type === 'grade_update') {
        wx.showModal({
          title: 'ğŸ“Š æ–°æˆç»©',
          content: `${event.data.course_name}: ${event.data.score}åˆ†`
        });
      }
    });
  }
});
```

---

**å¯¼å‡ºæ—¶é—´**: 2025-06-21 18:10  
**æ€»ç”¨æˆ·æ•°**: 8ä¸ª (5å­¦ç”Ÿ + 2æ•™å¸ˆ + 1ç®¡ç†å‘˜)  
**æ¨é€æµ‹è¯•**: è¿è¡Œ `python test_event_push.py` 